// Background images based on weather conditions
const weatherBackgrounds = {
    Clear: 'url("https://img.fotocommunity.com/sonniger-tag-an-der-hase-db6e4a8b-e4ac-4f11-8711-13923cc05ca7.jpg?height=1080")',
    Clouds: 'url("https://www.shutterstock.com/image-photo/cloudy-day-green-valley-600nw-627078857.jpg")',
    Rain: 'url("https://img.freepik.com/free-photo/weather-effects-composition_23-2149853295.jpg")',
    Drizzle: 'url("https://upload.wikimedia.org/wikipedia/commons/5/5b/Row_of_poplars_in_the_drizzle_-_geograph.org.uk_-_591822.jpg")',
    Thunderstorm: 'url("https://images.unsplash.com/photo-1561484936-c44366b9b1b1")',
    Snow: 'url("https://thumbs.dreamstime.com/b/snowy-trees-city-park-sunny-day-white-background-132778541.jpg")',
    Mist: 'url("https://w.wallhaven.cc/full/p8/wallhaven-p858pj.jpg")'
};

// Set a random background image on load
const backgroundKeys = Object.keys(weatherBackgrounds);
const randomBackground = weatherBackgrounds[backgroundKeys[Math.floor(Math.random() * backgroundKeys.length)]];
document.body.style.backgroundImage = randomBackground;

async function getWeather() {
    const city = document.getElementById('cityInput').value;
    if (!city) {
        alert('Please enter a city');
        return;
    }
    try {
        // Fetch geodata
        const geo_response = await fetch(`http://api.openweathermap.org/geo/1.0/direct?q=${city}&appid=3c5dbacc5e4db11ed8b00b8052e630a4`);
        const geo_data = await geo_response.json();

        if (geo_data.length === 0) {
            alert('City not found. Please try again.');
            return;
        }

        const lat = geo_data[0].lat;
        const lon = geo_data[0].lon;

        // Fetch weather data
        const response = await fetch(`https://api.openweathermap.org/data/2.5/weather?lat=${lat}&lon=${lon}&appid=3c5dbacc5e4db11ed8b00b8052e630a4&units=metric`);
        const data = await response.json();

        // Display the nearest weather station and weather data
        document.getElementById('station').innerText = `Nearest Weather Station: ${data.name}, ${data.sys.country}`;
        document.getElementById('weatherData').innerText = `Temperature: ${data.main.temp}Â°C, Condition: ${data.weather[0].description}`;

        // Change background image based on weather condition
        const mainWeather = data.weather[0].main;
        document.body.style.backgroundImage = weatherBackgrounds[mainWeather] || randomBackground;
    } catch (error) {
        alert('Error fetching weather data. Please try again.');
        console.error(error);
    }
}